<?php

namespace Freegle\Iznik;

# Set up gridids for locations already in the locations table; you might do this after importing a bunch of locations
# from a source such as OpenStreetMap (OSM).
require_once dirname(__FILE__) . '/../include/config.php';
require_once(IZNIK_BASE . '/include/db.php');
global $dbhr, $dbhm;

$g = new Group($dbhr, $dbhm);
$gid = $g->findByShortName('Oxford-High-Freegle');

if (!$gid) {
    # Not set up yet.
    error_log("Set up private environment");

    # A group.
    $gid = $g->create('Oxford-High', Group::GROUP_FREEGLE);
    $g->setPrivate('onhere', 1);
    $g->setPrivate('onmap', 1);
    $g->setPrivate(
        'polyofficial',
        'POLYGON((-1.2956999640624645 51.80054736819067,-1.3142395019531252 51.79078028408291,-1.3080596923828127 51.79205440859987,-1.3029098510742188 51.78058599210829,-1.3047981262207033 51.77506312202893,-1.3025665283203125 51.77060184885925,-1.2977600097656252 51.76529023435832,-1.2953567504882815 51.75981861797315,-1.294670104980469 51.75636531489065,-1.2929534912109375 51.75567462258247,-1.2922668457031252 51.754133809365285,-1.290292739868164 51.75349621610489,-1.2896060943603518 51.75078634432493,-1.285057067871094 51.74759805171374,-1.280937194824219 51.74611010481243,-1.2779331207275393 51.7458443948512,-1.274843215942383 51.744356390186766,-1.2722682952880862 51.74419695820865,-1.2669467926025393 51.74308091860788,-1.2517547607421877 51.73027106182234,-1.2519264221191408 51.728676219695025,-1.2480640411376955 51.72920783998977,-1.2407684326171877 51.72490153581528,-1.2415409088134768 51.72086067986095,-1.2369060516357424 51.71788297595214,-1.2345886230468752 51.71261834107178,-1.2339019775390627 51.704906406014544,-1.2208557128906252 51.69001067254529,-1.2256622314453125 51.672980972951365,-1.2373352050781252 51.66361190795317,-1.2115859850586048 51.633149329984484,-1.1072156139648541 51.66041795124659,-1.0644720634277292 51.66499657154186,-1.0622405978515417 51.724051323504554,-1.1254119079101201 51.764440756064296,-1.1579590011388066 51.7969806873283,-1.1630401527509096 51.80335006119369,-1.1995697021484377 51.80530316861373,-1.238845833577216 51.8160861614892,-1.2660369789227846 51.83051600282126,-1.289177387402333 51.806916871788765,-1.2956999640624645 51.80054736819067)) '
    );
    $g->setPrivate('lat', 51.751724);
    $g->setPrivate('lng', -1.255285);
}

# We need a postcode.
$l = new Location($dbhr, $dbhm);
$areaid = $l->create(NULL, 'Oxford High School', 'Polygon', 'POLYGON((-1.2603711891719405 51.77392324102254,-1.2576943445750777 51.77392324102254,-1.2576943445750777 51.77277142247232,-1.2603711891719405 51.77277142247232,-1.2603711891719405 51.77392324102254))');
$pcbigid = $l->create(NULL, 'OX2', 'Postcode', 'POINT(-1.304560 51.765964)');
$pcid = $l->create(NULL, 'OX2 6XA', 'Postcode', 'POINT(-1.259208 51.773430)');
$l = new Location($dbhr, $dbhm, $pcid);
$l->setPrivate('areaid', $areaid);
$l->setPrivate('postcodeid', $pcbigid);
